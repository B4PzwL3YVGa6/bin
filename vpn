#!/bin/dash
#
# http://github.com/mitchweaver/bin
#
# openvpn wrapper for ease of use 
#

[ $(id -u) -ne 0 ] && 
    { doas $0 "$@" ; exit $? ; }

cd /etc/openvpn || exit 1

[ "$(pgrep openvpn)" ] &&
    pkill -x openvpn

case "$1" in
    switzerland|-ch) loc=Switzerland  ;;
    canada|-ca)      loc=CA\ Montreal ;;
    singapore|-sg)   loc=Singapore    ;;
    norway|-no)      loc=Norway       ;;
    finland|-fl)     loc=Finland      ;;
    japan|-jp)       loc=Japan        ;;
    romania|-ro)     loc=Romania      ;;
    *) loc="$(ls *.ovpn | sort -R | head -n 1)"
       loc="${loc%.*}"
esac

openvpn ./$loc.ovpn > /dev/null &

echo -n "$loc" > /tmp/vpn
